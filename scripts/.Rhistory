as.POSIXct("2017-02-15 19:00:00",
tz= "Europe/Budapest"))
)
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),
vjust=-1,hjust=-3,size=3,angle = 90, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=25,label=name),
hjust=-3,size=3,angle = 90, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=25,label=name),size=3,angle = 90, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 45, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 40, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 35, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 30, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,50))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,45))
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,48))
exploreDates("2017-02-15+19:00:00","2017-02-15+20:30:00")
exploreDates("2017-02-15+20:30:00","2017-02-15+22:30:00")
exploreDates("2017-02-15+21:30:00","2017-02-15+22:30:00")
exploreDates("2017-02-15+20:30:00","2017-02-15+21:30:00")
exploreDates("2017-02-15+21:00:00","2017-02-15+21:30:00")
exploreDates("2017-02-15+21:30:00","2017-02-15+22:00:00")
exploreDates("2017-02-15+22:00:00","2017-02-15+22:30:00")
exploreDates("2017-02-15+21:00:00","2017-02-15+22:30:00")
exploreDates("2017-02-15+22:00:00","2017-02-15+23:30:00")
exploreDates("2017-02-15+20:00:00","2017-02-15+23:30:00")
exploreDates("2017-02-15+20:00:00","2017-02-15+21:30:00")
exploreDates("2017-02-15+20:00:00","2017-02-15+21:00:00")
exploreDates("2017-02-15+20:00:00","2017-02-15+20:45:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+21:00:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+20:45:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+20:20:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+20:30:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+20:45:00")
exploreDates("2017-02-15+20:15:00","2017-02-15+20:55:00")
exploreDates("2017-02-15+20:50:00","2017-02-15+20:55:00")
exploreDates("2017-02-15+20:45:00","2017-02-15+20:55:00")
events <- data.frame(name = c("Journey 1", "Journey 2", "Journey 3","Journey 4","Journey 5"),
time =c(as.POSIXct("2017-02-15 08:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 10:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 14:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 17:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 19:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 20:45:00",
tz= "Europe/Budapest"))
)
events <- data.frame(name = c("Journey 1", "Journey 2", "Journey 3","Journey 4","Journey 5","Journey 6"),
time =c(as.POSIXct("2017-02-15 08:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 10:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 14:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 17:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 19:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 20:45:00",
tz= "Europe/Budapest"))
)
all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,48))
exploreDates("2017-02-15+20:55:00","2017-02-15+23:55:00")
events <- data.frame(name = c("Journey 1", "Journey 2", "Journey 3","Journey 4","Journey 5","Journey 6"),
time =c(as.POSIXct("2017-02-15 08:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 10:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 14:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 17:30:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 19:00:00",
tz= "Europe/Budapest"),
as.POSIXct("2017-02-15 20:45:00",
tz= "Europe/Budapest"))
)
distanceTime<- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,48))
distanceTime<- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=-5,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,48))
accuracyTime <- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = accuracy) %>%
ggplot( aes(x = time, y=rDistPrev))+
geom_line()+theme_tufte()+
xlab("Time")+ylab("Accuracy")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)
library(gridExtra)
library(grid)
locShift<- grid.arrange(distanceTime,accuracyTime,ncol=1)
distanceTime<- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=48,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-8,55))
accuracyTime <- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = accuracy) %>%
ggplot( aes(x = time, y=rDistPrev))+
geom_line()+theme_tufte()+
xlab("Time")+ylab("Accuracy")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)
library(gridExtra)
library(grid)
locShift<- grid.arrange(distanceTime,accuracyTime,ncol=1)
distanceTime<- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = distancePrev) %>%
ggplot( aes(x = time, y=rDistPrev*1000))+
geom_line()+theme_tufte()+
xlab("")+ylab("Distance over time")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)+
geom_text(data=events,
aes(x=time,y=50,label=name),size=3,angle = 90, colour= muted("red"))+
ylim(c(-1,57))
accuracyTime <- all %>%
select(time,lon,lat,accuracy) %>%
as_tbl_time(index = time) %>%
time_filter(2017-02-15 ~ 2017-02-15)%>%
mutate( distanceHome = sp::spDistsN1(pts=matrix(c(lon,lat),ncol = 2),
pt = home,
longlat = T),
euclon = lon-home[1],
euclat = lat-home[2],
distancePrev = c(0,
sp::spDists(x=matrix(c(lon,lat),ncol = 2), segments = T)),
rDistPrev = accuracy) %>%
ggplot( aes(x = time, y=rDistPrev))+
geom_line()+theme_tufte()+
xlab("Time")+ylab("Accuracy")+
scale_x_datetime(breaks = date_breaks("4 hour"),
minor_breaks=date_breaks("2 hour"),
labels=date_format("%H:%M:%S", tz = "Europe/Budapest"),
limits = xlim_p1)
library(gridExtra)
library(grid)
locShift<- grid.arrange(distanceTime,accuracyTime,ncol=1)
#square
ggsave(locShift,filename = "../img/accuracyLocShiftSquare.png",device = "png",height = 6.5,width = 6.5, units = "cm")
getwd()
#long
ggsave(locShift,filename = "../img/accuracyLocShift.png",device = "png",height = 8,width = 20, units = "cm")
#long
ggsave(locShift,filename = "../img/accuracyLocShift.png",device = "png",height = 10,width = 20, units = "cm")
#long
ggsave(locShift,filename = "../img/accuracyLocShift.png",device = "png",height = 15,width = 20, units = "cm")
devtools::install_github("rstudio/bookdown")
?papaya
install.packages("rmarkdown")
